{"version":3,"sources":["../server-src/app.js"],"names":[],"mappings":"uSAAA,4B;AACA,0B;AACA,uC;AACA,+C;AACA,qC;AACA,uC;AACA,yC;AACA,mC;AACA,uC;AACA,uC;AACA,uC;;AAEA,IAAM,MAAM,mBAAZ;AACA,IAAM,SAAS,yBAAf;;AAEA;AACA,IAAI,GAAJ,CAAQ,8BAAR;AACA,IAAI,GAAJ,CAAQ,wBAAR;AACA,IAAI,GAAJ,CAAQ,0BAAR;;AAEA;AACA,IAAI,GAAJ,CAAQ,yBAAU,eAAK,IAAL,CAAU,SAAV,EAAqB,WAArB,CAAV,CAAR;;AAEA;AACA,IAAI,GAAJ,CAAQ,wBAAM,eAAK,IAAL,CAAU,SAAV,EAAqB,UAArB,CAAN,EAAwC;AAC9C,aAAW,MADmC,EAAxC,CAAR;;;AAIA;AACA,QAAQ,GAAR,CAAY,QAAZ,GAAuB,QAAQ,GAAR,CAAY,QAAZ,IAAwB,aAA/C;AACA,IAAG,IAAI,GAAJ,KAAY,aAAf,EAA6B;AAC3B,MAAM,UAAU,QAAQ,SAAR,CAAhB;AACA,MAAI,YAAY,QAAQ,uBAAR,CAAhB;AACA,MAAM,WAAW,QAAQ,SAAR,CAAjB;AACA,MAAM,uBAAuB,QAAQ,4BAAR,CAA7B;AACA,MAAM,uBAAuB,QAAQ,4BAAR,CAA7B;AACA,MAAI,GAAJ,CAAQ,0BAAQ,qBAAqB,QAArB,EAA+B;AAC3C,YAAQ,KADmC;AAE3C,gBAAY,UAAU,MAAV,CAAiB,UAFc;AAG3C,WAAO;AACL,cAAQ,IADH,EAHoC,EAA/B,CAAR,CAAR;;;AAOA,MAAI,GAAJ,CAAQ,0BAAQ,qBAAqB,QAArB,CAAR,CAAR;AACD;;AAED;AACA,IAAI,GAAJ,oFAAQ,iBAAO,GAAP,EAAY,IAAZ;;AAEE,oBAFF;;AAIJ,gBAAG,YAAI,MAAJ,KAAe,GAAlB,EAAuB;AACrB,kBAAI,IAAJ,GAAW,EAAE,SAAS,sBAAX,EAAX;AACA,kBAAI,MAAJ,GAAa,GAAb;AACD,aAHD,MAGO;AACL,kBAAI,IAAJ,GAAW,EAAE,SAAS,YAAI,OAAf,EAAX;AACA,kBAAI,MAAJ,GAAa,YAAI,MAAJ,IAAc,GAA3B;AACD,aAVG,6EAAR;;;;AAcA;AACA,OAAO,GAAP,CAAW,GAAX,EAAgB,gBAAM,MAAN,EAAhB,EAAgC,gBAAM,cAAN,EAAhC;AACA,OAAO,GAAP,CAAW,QAAX,EAAqB,gBAAM,MAAN,EAArB,EAAqC,gBAAM,cAAN,EAArC;;AAEA,IAAI,GAAJ,CAAQ,OAAO,MAAP,EAAR;;AAEA,IAAI,EAAJ,CAAO,OAAP,EAAgB,UAAS,GAAT,EAAc,GAAd,EAAkB;AAChC,UAAQ,GAAR,CAAY,GAAZ;AACA,sBAAO,KAAP,CAAa,cAAb,EAA6B,GAA7B,EAAkC,GAAlC;AACD,CAHD;;AAKA,IAAI,MAAJ,CAAW,IAAX,EAAiB,oBAAM,QAAQ,GAAR,CAAY,qBAAZ,CAAN,EAAjB,E;;AAEe,G","file":"app.js","sourcesContent":["import path from 'path'\nimport Koa from 'koa'\nimport Router from 'koa-router'\nimport bodyParser from 'koa-bodyparser'\nimport views from 'koa-views'\nimport koaStatic from 'koa-static'\nimport convert from 'koa-convert'\nimport json from 'koa-json'\nimport logger from 'koa-logger'\nimport index from './routes/index'\nimport about from './routes/about'\n\nconst app = new Koa()\nconst router = new Router()\n\n//middlewares\napp.use(bodyParser())\napp.use(json()) \napp.use(logger())\n\n// static\napp.use(koaStatic(path.join(__dirname, '../client')))\n\n// views\napp.use(views(path.join(__dirname, '../views'), {\n  extension: 'jade'\n}))\n\n// webpack config\nprocess.env.NODE_ENV = process.env.NODE_ENV || 'development'\nif(app.env === 'development'){\n  const webpack = require('webpack')\n  let devConfig = require('../webpack.config.dev')\n  const compiler = webpack(devConfig)\n  const webpackDevMiddleware = require(\"koa-webpack-dev-middleware\")\n  const webpackHotMiddleware = require(\"koa-webpack-hot-middleware\")\n  app.use(convert(webpackDevMiddleware(compiler, {\n      noInfo: false,\n      publicPath: devConfig.output.publicPath,\n      stats: {\n        colors: true\n      }\n  })))\n  app.use(convert(webpackHotMiddleware(compiler)))\n}\n\n// response\napp.use(async (ctx, next) => {\n  try {\n    await next()\n  } catch(err) {\n    if(err.status === 401) {\n      ctx.body = { message: 'Unauthorized access.' }\n      ctx.status = 401\n    } else {\n      ctx.body = { message: err.message }\n      ctx.status = err.status || 500\n    }\n  }\n})\n\n//router\nrouter.use('/', index.routes(), index.allowedMethods())\nrouter.use('/about', about.routes(), about.allowedMethods())\n\napp.use(router.routes())\n\napp.on('error', function(err, ctx){\n  console.log(err)\n  logger.error('server error', err, ctx)    \n})\n\napp.listen(3000, () => console.log('server started 3000'))\n\nexport default app"]}